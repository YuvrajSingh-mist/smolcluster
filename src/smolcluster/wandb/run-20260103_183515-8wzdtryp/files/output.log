==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
SimpleMNISTModel                         [4, 10]                   --
├─Linear: 1-1                            [4, 256]                  200,960
├─ReLU: 1-2                              [4, 256]                  --
├─Linear: 1-3                            [4, 512]                  131,584
├─ReLU: 1-4                              [4, 512]                  --
├─Linear: 1-5                            [4, 10]                   5,130
==========================================================================================
Total params: 337,674
Trainable params: 337,674
Non-trainable params: 0
Total mult-adds (Units.MEGABYTES): 1.35
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.02
Params size (MB): 1.35
Estimated Total Size (MB): 1.39
==========================================================================================
[Leader] Model Summary:
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
SimpleMNISTModel                         [4, 10]                   --
├─Linear: 1-1                            [4, 256]                  200,960
├─ReLU: 1-2                              [4, 256]                  --
├─Linear: 1-3                            [4, 512]                  131,584
├─ReLU: 1-4                              [4, 512]                  --
├─Linear: 1-5                            [4, 10]                   5,130
==========================================================================================
Total params: 337,674
Trainable params: 337,674
Non-trainable params: 0
Total mult-adds (Units.MEGABYTES): 1.35
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.02
Params size (MB): 1.35
Estimated Total Size (MB): 1.39
==========================================================================================
[Leader] Accepted connection from ('127.0.0.1', 50054)
[Leader] Handling worker at ('127.0.0.1', 50054)
2026-01-03 18:35:20,857 - Server - INFO - Handling worker at ('127.0.0.1', 50054)
[Leader] Accepted connection from ('127.0.0.1', 50055)
[Leader] Handling worker at ('127.0.0.1', 50055)
[Leader] All workers connected. Starting training...
[Leader] Starting training for 10 epochs.
[Leader] Starting epoch 1/10
Traceback (most recent call last):
  File "/Users/yuvrajsingh9886/Desktop/smolcluster/src/smolcluster/./server.py", line 356, in <module>
    main()
    ~~~~^^
  File "/Users/yuvrajsingh9886/Desktop/smolcluster/src/smolcluster/./server.py", line 243, in main
    leader_grads = compute_leader_gradients(model, data, target, criterion)
TypeError: compute_leader_gradients() missing 1 required positional argument: 'optimizer'
[Leader] Received gradients from worker ('127.0.0.1', 50055) with ID 2 for batch 0
2026-01-03 18:35:24,708 - Server - INFO - Received gradients from worker ('127.0.0.1', 50055) with ID 2 for batch 0

[Leader] Storing gradients from worker 2 for batch 0
2026-01-03 18:35:24,709 - Server - INFO - Storing gradients from worker 2 for batch 0
Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.13/threading.py", line 1540, in _shutdown
    _thread_shutdown()
KeyboardInterrupt:
